# 台球式撞击游戏设计文档

## 项目概述

基于回合制的台球式撞击游戏，核心玩法为：**台球式撞击 → 白球停下后 3 秒'微移' → 敌人按上回合预告执行攻击 → 敌人移动 → 刷新下回合预告 → 进入新一轮蓄力撞击**。

## 核心设计理念

- **可控的落点**：通过物理限制和微移机制确保玩家对白球位置有控制感
- **信息对称**：敌人行为完全预告，玩家可以基于信息制定策略
- **回合制节奏**：明确的回合划分，避免混乱的实时战斗

## 一、最小可玩内容清单（MVP）

### 1. 回合与状态系统

**状态机流程：**
```
Player_Aim（蓄力/瞄准）→ Player_Dash（出杆/冲刺）→ Post_Move（3 秒微移窗口）→ Enemy_Act（按预告结算）→ Enemy_Telegraph（生成下回合预告）→ 循环
```

**胜利条件：**
- 清场（消灭所有敌人）

**失败条件：**
- 白球生命归零
- 回合上限达到

### 2. 玩家核心交互

**蓄力与方向：**
- 按住左键蓄力（力度条显示）
- 鼠标移动调整发射方向
- 松开发射白球

**碰撞结算：**
- 击中敌人造成伤害
- 白球因碰撞损失速度并最终停下

**3秒微移机制：**
- 白球停止后，左键点击地面触发"缓慢位移"
- 匀速或插值移动，设定最大总位移半径/步数限制
- UI倒计时显示剩余时间

**物理限制：**
- 地面摩擦/线性阻尼（保持真实感）
- 合理的反弹系数（避免过度弹跳）
- 边界能量吸收（防止无限循环）

### 3. 敌人基础系统

**敌人：**
- 下回合向白球位移并造成接触伤害
- 有预告箭头显示移动路径
- 进入Enemy_Act时一次性结算

### 4. UI/反馈系统

**核心UI元素：**
- 力度条（蓄力时显示）
- 瞄准线（预测前1~2次反弹）
- 白球与敌人血条
- 3秒微移倒计时

**回合提示：**
- 顶部状态显示："玩家回合 / 敌人回合"

### 5. 关卡与目标

**地图设计：**
- 1张小地图（矩形场地 + 简单障碍）
- 边界清晰，避免无限弹跳

**目标类型：**
- 清场（消灭所有敌人）

### 6. 视觉风格

**基础视觉：**
- 简洁配色方案
- 白球高亮显示
- 敌人对比色区分
- 预告箭头用半透明色

## 二、避免"弹珠台失控"的关键参数

### 物理限制参数

- **速度阈值停球**：低于设定值立即视为停止，进入微移
- **边界吸附/软化**：墙体轻微能量吸收，角度限制到[15°,165°]
- **命中后减速系数**：每次命中按比例掉速，控制后半程

### 策略性设计

- **瞄准线设计**：预测1~2次反弹，显示完整撞击路径和预期命中点
- **敌人硬直**：被撞后短暂停滞/位移，减少"撞完立刻反打"的挫败感

## 三、技术架构建议

### 核心脚本/模块

1. **TurnManager**：驱动状态机与回合流转
2. **AimController**：方向/力度输入、瞄准线绘制
3. **WhiteBall**：运动与碰撞回调、停球检测、微移执行
4. **EnemyBase**：持有Intent，实现PlanIntent()/ExecuteIntent()两步
5. **TelegraphRenderer**：把Intent可视化（箭头/范围圈/倒计时）
6. **DamageSystem**：伤害、硬直、击退
7. **HUD**：力度条、回合提示、倒计时环、血条与飘字

### 数据结构

**敌人配置：**
- HP、受撞伤害系数
- 移动速度

**物理常量：**
- 反弹上限、阻尼
- 停球阈值、命中减速系数
- 边界吸能参数

**关卡数据：**
- 边界尺寸、障碍位置

## 四、项目形态建议：优先2D

### 为什么选择2D

1. **物理可控性**：Unity 2D刚体 + BoxCollider2D/CircleCollider2D，易设阻尼与反弹上限
2. **表现需求匹配**：核心不是旋转/杆法而是战术落点与意图博弈
3. **开发速度**：摄像机、UI、预告形状在2D中实现更简单
4. **可升级空间**：未来可迁到伪2.5D（等距阴影、法线贴图）

### 何时考虑3D

- 需要真实台球技巧（上旋、侧旋、跳球）
- 立体障碍/高低差
- 近景炫酷镜头

## 五、第一版数值建议

### 基础参数

- **白球基础速度**：以"最长2~2.5次场宽"的位移量为上限
- **敌人HP**：白球平均一次撞击≈敌人40%～60% HP（2次命中能击杀）
- **敌人行动**：每回合移动并攻击
- **微移预算**：3秒内总位移半径≈白球直径2~3倍，可分多次点击使用

## 六、开发里程碑

### M0（当天）
- [ ] 白球蓄力发射
- [ ] 碰撞停球检测
- [ ] 瞄准线绘制

### M1（+1~2天）
- [ ] 3秒微移机制（含预算/计时）
- [ ] 回合框架搭建
- [ ] 基础敌人 + 意图可视化

### M2（+1~2天）
- [ ] 伤害与血条系统
- [ ] 胜负结算
- [ ] 手感打磨（反弹上限/阻尼/命中减速）

## 七、美术占位方案

### 临时资源
- 白球/敌人：简易圆形或小图标
- 预告箭头：使用LineRenderer

## 八、总结

这套设计足以构成完整可玩的demo，优先2D来更快验证"落点可控 + 明确意图"的核心体验。先小步快跑，把反弹控制与预告信息打磨清晰，手感稳了，再谈扩展。

---

**文档版本**：v1.0  
**创建日期**：2024年  
**最后更新**：2024年
